{set:$seller_id = $this->seller['seller_id']}
{set:$searchParam = http_build_query(Util::getUrlParam('search'))}
{set:$condition = Util::search(IReq::get('search'));
	$where = $condition ? " and ".$condition : "";
}
{query:name=delivery }
	{set:$delivery_id=$item['id']}
	{set:$kuaidi["$delivery_id"] = $item['name']}
{/query}
<style>
	.tab_current{background:#24b408 !important;color:#fff !important;}
</style>
<article class="module width_full">
	<header>
		<h3 class="tabs_involved">平台推荐学员</h3>
		<ul class="tabs">
			<!-- <li><input type="button" class="alt_btn" onclick="filterResult();" value="检索" /></li> -->
			<li><input type="button" class="alt_btn tab_current" onclick="javascript:location.href='/seller/order_tutor_list'" value="家教订单" /></li>
		</ul>
	</header>

	<table class="tablesorter" cellspacing="0">
		<colgroup>
			<col width="205px" />
			<col width="150px" />
			<col width="125px" />
			<col width="125px" />
      <col width="115px" />
			<col width="155px" />
			<col width="125px" />
			<col />
		</colgroup>
		<thead>
			<tr>
				<th>学员姓名</th>
				<th>联系电话</th>
				<th>推荐编号</th>
				<th>关注课程</th>
				<th>课程属性</th>
				<th>订单状态</th>
				<th>推荐时间</th>
				<th>提示</th>
				<th>操作</th>
			</tr>
		</thead>

		<tbody>
			{set:$page = IReq::get('page') ? IFilter::act(IReq::get('page'),'int') : 1}
			{query:name=order as o fields=o.* page=$page where=o.seller_id eq $seller_id and o.pay_status eq 1 and o.if_del eq 0 and o.statement eq 4 and o.status not in(3,4) $where  id=$orderObject order=o.id desc}
			{set:$order_status_t = Order_Class::getOrderStatus($item);}
			{set:$goods_list = Order_Class::get_order_goods_list($item['id'])}
			{set:$goods = $goods_list[0]}
			{set:$goods_array = $goods['goods_array']}
			<tr>
				<td title="{$item['accept_name']}">{$item['accept_name']}</td>
				<td title="{$item['mobile']}">{$item['mobile']}</td>
				<td title="{$item['order_no']}" name="orderStatusColor{$item['status']}">{$item['order_no']}</td>
        <td>{$goods_array->name}</td>
        <td>{$goods_array->value}</td>
				<td>
					<b class="{if:$order_status_t >= 6}green{else:}orange{/if}">
					{echo:order_class::orderStatusText(order_class::getOrderStatus($item),2, $item['statement'])}
					</b>
				</td>
				<td title="{$item['create_time']}">{echo: date('Y-m-d H:i', strtotime($item['create_time']))}</td>
				<td>{echo:order_class::get_order_notice(order_class::getOrderStatus($item),2, $item['statement'])}</td>
				<td>
						{if:in_array( order_class::getOrderStatus( $item ), array(4))}
							<a href="{url:/seller/order_finish/order_id/$item['id']}">确认完成</a>
						{/if}
						<a href="{url:/seller/order_show_tutor/id/$item[id]}">详情</a>
				</td>
			</tr>
			{/query}
		</tbody>
	</table>
	{$orderObject->getPageBar()}
</article>

<script type="text/html" id="orderTemplate">
	<form action="{url:/}" method="get" name="filterForm">
		<input type='hidden' name='controller' value='seller' />
		<input type='hidden' name='action' value='order_prop_list' />
		<div class="module_content">
			<fieldset>
				<label>订单号</label>
				<input name="search[order_no=]" value="" type="text" />
			</fieldset>

			<fieldset>
				<label>学员姓名</label>
				<input name="search[accept_name=]" value="" type="text" />
			</fieldset>
		</div>
	</form>
</script>

<script language="javascript">
	//检索课程
	function filterResult(){
		var ordersHeadHtml = template.render('orderTemplate');
		art.dialog(	{		"init":function()
		{
			var filterPost = {echo:JSON::encode(IReq::get('search'))};
			var formObj = new Form('filterForm');
			for(var index in filterPost)
			{
				formObj.setValue("search["+index+"]",filterPost[index]);
			}
		},
		"title":"检索条件",
		"content":ordersHeadHtml,
		"okVal":"立即检索",
		"ok":function(iframeWin, topWin)
		{
			iframeWin.document.forms[0].submit();
		}
	});
}

//DOM加载结束
$(function(){
	//高亮色彩
	$('[name="payStatusColor1"]').addClass('green');
	$('[name="disStatusColor1"]').addClass('green');
	$('[name="orderStatusColor3"]').addClass('red');
	$('[name="orderStatusColor4"]').addClass('red');
	$('[name="orderStatusColor5"]').addClass('green');
});
</script>
